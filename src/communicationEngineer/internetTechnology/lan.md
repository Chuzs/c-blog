---
# 这是文章的标题

title: 第二章 局域网

# 你可以自定义封面图片

cover: /assets/images/cover2.jpg

# 这是页面的图标

icon: fa-solid fa-file-lines

# 这是侧边栏的顺序

order: 2

# 设置作者

author: Mr.Chuzs

# 设置写作时间

date: 2023-08-12

# 一个页面可以有多个分类

category:

- 通信工程师考试

# 一个页面可以有多个标签

tag:

- 计算机网络

# 此页面会在文章列表置顶

sticky: true

# 此页面会出现在文章收藏中

star: true

# 你可以自定义页脚

# footer: 你走的每一步都算数

# 你可以自定义版权信息

# copyright: Copyright © 2023 Mr.Chuzs

---

`第二章` 局域网

<!-- more -->
## 1 局域网基本原理

将分散在有限地理范围内的多台计算机通过传输介质连接起来的通信网络，通过功能完善的网络软件，实现计算机之间的相互通信和资源共享

### 1.1 局域网的标准（**了解**）

1. IEEE802.1———通用网络概念及体系结构
2. IEEE802.2———逻辑链路控制
3. IEEE802.3———载波监听多路访问/冲突检测规范
4. IEEE802.4———令牌总线结构及访问方法、物理层规范
5. IEEE802.5———令牌环的访问方法、物理层规范
6. IEEE802.6———城域网的访问方法、物理层规范
7. IEEE802.7———宽带局域网
8. IEEE802.8———光纤局域网
9. IEEE802.9———语音数据局域网的介质访问控制方法及物理层规范技术
10. IEEE802.10———局域网信息安全
11. IEEE802.11———无线局域网
12. IEEE802.12———100VG-AnyLAN的介质访问控制方法及物理层规范技术
13. IEEE802.13———无线城域网

局域网中不需要路由选择和流量控制功能，其他网络层功能可以由数据链路层实现，因此局域网中可以不设置网络层

### 1.2 局域网的基本组成及特点（**掌握**）

1. **局域网的组成**
    - 计算机
    - 传输介质
    - 网络适配器
    - 网络操作系统

2. **局域网的特点**
    - 网络覆盖范围小
    - 数据传输速率较高
    - 传输质量好，误码率低（通常小于10^-8^）
    - 介质访问控制方法相对简单
    - 软硬件设施及协议方面有所简化

### 1.3 拓扑结构（**掌握**）

1. **星形结构**
**构成**：由中心节点和分支节点构成，各分支节点与中心节点均具有点到点的物理连接，分支节点之间没有直接的物理通路。
**原理**：分支节点之间需要传递信息必须通过中心节点进行转发；或者由中心节点周期性询问分支节点，协助分支节点进行信息的转发
**优点**：中间是控制节点，任意两个节点通信只需两步，所以传输速率很快。结构简单、建网方便、便于控制和管理。
**缺点**：可靠性取决于中心节点，对中心节点的可靠性和冗余度要求很高
**应用**：通常用于集线器或交换机作为中心连接设备。
   - 集线器工作在物理层，只具有放大和重发数据功能。原理：从一台成员计算机发送到集线器上，被转发到集线器中的其他所有端口上，供网络上的所有用户使用。优点：集线器正常时，局部线路故障只会在局部造成影响。所有连接的集线器的设备共享同一介质，因此它们也共享同一个冲突域、广播和带宽
   - 交换机作为中间节点时，根据收到的数据帧中的MAC地址决定数据帧发送到哪个端口。端口间的帧传输彼此屏蔽，节点发送的帧数据在通过交换机时不会与其他节点发送的帧产生冲突，可以极大减少冲突发生

2. **总线型结构**
**构成**：各节点设备和一根总线相连。
**原理**：工作站发出的数据组成帧，数据帧沿着总线向两端传播，每个数据帧都含有远地址和目标地址，工作站监视总线上的信号，将发送给自己的复制下来。由于总线是共享介质，多个站同时发送会发生冲突，需要介质访问控制协议来防止冲突发生，如带有冲突检测的载波监听多路访问技术（CSMA/CD）
传输介质：同轴电缆、双绞线和光纤。双绞线便宜、便于安装。同轴电缆和光纤能提供更高的传输速率，连接更多设备，传输距离更远。总线型结构的负载能力由通信介质的物理性质决定
**优点**：易于布线和维护；结构简单传输介质时无源元件，十分可靠；可扩充性好，节点设备插入和拆除都非常方便；网络节点间想要速度快，共享资源能力强，设备投入量少，成本低，安装使用方便。
**缺点**：由于所有工作站之间的通信均通过一条共用的总线，实时性较差；不是集中控制，故障检测要在各个站点进行；扩展总线长度时需重新配置中继器、剪裁电缆、调整终端器等；站点需要具备介质访问控制控制功能，增加了站点等硬件和软件费用

3. **环形结构**
**构成**：网络中各节点通过一条首尾相连的通信链路连接，形成一个闭合的环
**原理**：发送数据时先将数据发送到环接口设备，沿环路发往其下行的环接口设备，该设备对其进行转或者递交给设备附接的节点。环接口设备通常从一端接收数据，从另一端发出数据，因此整个环路中的数据是单向流动的
**优点**：各个工作站地位相等，相互独立。某个故障时，自动旁路，不影响全网，可靠性较高。两个工作站只有一条通路，无信道选择问题
**缺点**：传输路径过长、传输节点过多场景时，端到端传送时延过大。适合结构简单、短距离网络，不适合大规模的长途骨干网
**传输介质**：可以使用任何传输介质。双绞线价格低，同轴电缆带宽高，光纤数据传输速率大
**应用**：令牌环局域网。只有拥有令牌的设备才能在网络中传输数据，以此来保证某一时间内只有一台设备可以传送信息
4. **混合型结构**
   将上述拓扑混合起来。常见的：树形，环星形

## 2 局域网协议

### 2.1 LLC子层（**掌握**）

1. **LLC子层功能**
IEEE802.2描述`LLC子层`的功能及特性的协议规范。属于数据链路层的一个子层，使用MAC子层提供的服务，通过与对等实体中`LLC子层`的交互为网络层提供服务
  
2. **网络层与LLC子层间接口的服务规范**
同一系统中上下层通信通过`服务访问点`（SAP，Service Access Point）实现。
   - 无确认无连接的服务：无需建立逻辑链路，既不确认也不进行任何流量控制或差错恢复
   - 有确认无连接的服务：对LLC帧进行确认，适合传送少量而且重要对数据
   - 面向连接的服务：建立逻辑链路，按序发送，提供差错恢复和流量控制功能。可靠性高，建立连接时间增加

3. **LLC子层与MAC子层间接口的服务规范**
通过`介质访问控制服务访问点`（MAC， Media Access Control）使用`MAC子层`为它提供的服务。`MAC子层`负责实现帧的寻址和识别。`MAC子层`向`LLC子层`提供服务时使用的原语：MA-DATA.request、MA-DATA.indication、MA-DATA.confirm

4. **LLC子层与LLC子层间的接口的服务规范**
在OSI/RM中，一个实体与其对等实体之间的通信是由由两个对等实体间的协议来定义

5. **LLC子层的协议规范**

::: center
**表2-1** **LLC子层PDU格式**
:::
| 1个字节 | 1个字节 | 1个或2个字节 | N个字节 |
| :-----: | :-----: | :----------: | :-----: |
|  DSAP   |  SSAP   |   控制字段   | LLC数据 |

LLC数据是上层传下来的数据；`目的服务访问点`（Destination Service Access Point）、`源服务访问点`（Source Service Access Point）和`控制字段`是`LLC子层`添加的控制头部
（1）`DSAP`结构如表2-2所示
::: center
**表2-2** **DSAP结构**
:::
|  1比特   |  7比特   |
| :------: | :------: |
| 地址类型 | 实际地址 |

**地址类型**：在`DSAP`结构中占1比特。`0`表示单个`DSAP`，`1`表示组`DSAP`
**实际地址**：在`DSAP`结构中占7比特

（2）`SSAP`结构如表2-3所示
::: center
**表2-3** **SSAP结构**
:::
|   1比特   |  7比特   |
| :-------: | :------: |
| 命令/响应 | 实际地址 |

**命令/响应标志位**：用来识别`LLC`的`PDU`是命令还是响应。`0`表示命令，`1`表示响应
**实际地址**：在`SSAP`结构中占7比特

`DSAP`字段全`1`为全局地址，由MAC实际服务的全部`DSAP`组成。`DSAP`或`SSAP`地址全`0`为空地址，空地址表示与`MAC`的服务访问点地址有关的`LLC`，不识别网络层或有关管理的任何服务访问点

（3）控制字段结构如表2-4所示
::: center
**表2-4** **控制字段结构**
:::
<table>
   <thead>
      <tr>
         <th></th>
         <th>1比特</th>
         <th colspan="4">7比特</th>
         <th>1比特</th>
         <th>7比特</th>
      </tr>
   </thead>
   <tbody>
      <tr>
         <td>信息帧</td>
         <td>0</td>
         <td colspan="4">N(S)</td>
         <td>P/F </td>
         <td>N(R)</td>
      </tr>
      <tr>
         <td>管理帧</td>
         <td>1</td>
         <td>0</td>
         <td>SS</td>
         <td colspan="2">XXXX</td>
         <td>P/F </td>
         <td>N(R)</td>
      </tr>
      <tr>
         <td>无编号帧</td>
         <td>1</td>
         <td>1</td>
         <td>MM</td>
         <td>P/F</td>
         <td>MMM</td>
         <td colspan="2"></td>
      </tr>
   </tbody>
</table>

**信息帧**：2字节，信息数据传输，第一位为`0`
**管理帧**：2字节，流量控制，前两位为`10`
**无编号帧**：1子节。用于`LLC子层`控制信号的传输，以建立或释放逻辑电路，前两位为`11`

N(S)——发送端发送序列号，帧的序列号
N(R)——发送端接收序列号，指示下一次希望接收的帧序列号。与`N(S)`配合工作以实现流量和差错控制功能
P/F——Poll/Final位（探询/终止位）
S——管理功能位，含义如下

- 00——准备接收，通过`N(R)`指示下一次希望接收的帧序列号
- 01——拒绝，拒收`N(R)`及`N(R)`之后的所有帧
- 10——未准备接收，通过`N(R)`指示下一次希望接收的帧序列号，同时通知发送端停止发送
- 11——选择拒绝，拒收序列号为`N(R)`的帧

M——修正功能位
X——预留位，设置位`0`

（4）LLC数据。长度为8的倍数，上限取决于所使用的介质访问控制方法
 `LLC子层`和`MAC子层`都添加了相应的头部（及尾部），其中包含的是本层与对等实体间的交互信息。`LLC PDU`和`MAC`帧都包含地址信息，`MAC`中的是数据帧的源和目的地址（即`MAC地址`），`LLC PDU`中的是源或目的端端服务访问点

### 2.2 MAC子层（**了解**）

网络中传输介质可以共享，但不能同时传送多个帧，某个节点发送数据时需要先获取对介质的访问权。`MAC子层`就是用来实现介质访问控制功能的网络实体

**主要功能**：数据帧的封装/卸载、帧的寻址与识别、帧的接收与发送、链路的管理、帧的差错控制、`MAC`协议的维护

根据介质访问控制权归属

- **集中式**：指定某个控制节点拥有网络访问控制权
- **分布式**：各节点集体完成介质访问控制功能，动态确定各节点的发送顺序

根据各节点可用通信流量的分配方式

- **同步方式**：每个节点分配一定的带宽，不适用于局域网，带宽不能随节点流量改变
- **异步方式**：根据实际情况为节点分配带宽
  - **循环式（常用）**：每个节点按照一定的顺序传递发送权限。每次只能发送限量数据，超过限量的只能再下一轮发送。可能集中式或分布式
  - **预约式**：介质上的时间划分为许多时隙，发送数据需要提前预约时隙。可能集中式或分布式
  - **竞争式（常用）**：由各个工作站自由竞争发送，适合分布式控制

IEEE规定的MAC子层有`CSMA/CD`、`令牌总线`、`令牌环`等

### 2.3 物理层（**了解**）

**功能**：实现比特流的传输，数据通信的基础。
物理层协议规定了建立、维持及断开物理信道的有关特性，包括：

- **机械特性**：连接器的标准
- **电气特性**：规定导线的电气连接方式、信号电平、发生器的输出阻抗、接收器的输入阻抗
- **功能特性**：说明了接口信号的特定功能
- **规程**：规定了使用交换电路进行数据交换的控制步骤

## 3 以太网

### 3.1 MAC子层协议（**掌握**）

LLC子层协议添加的地址是用来识别源或目的端的服务访问点的，而源或目的端端主机地址由MAC子层地址来识别

1. 以太网的MAC地址
为了标识每台主机，给网卡分配的唯一地址
组成：6字节即48比特，前3个字节是厂商向IEEE申请的组织唯一标识（Organizationally Unique Identifier，OUI），后3个字节为生产厂商自行为自己生产的网卡分配的标识符。
::: center
**以太网MAC地址的结构**
:::
|1比特|1比特|22比特|24比特|
|:-:|:-:|:-:|:-:|
|I/G|U/L|IEEE分配的子网地址| 局部分配的物理地址|

I/G：0表示私有地址，1标识组地址
U/L：0表示由全局管理团体设置，1表示局部分配
2. 以太网帧格式
以太网标准`DIX2.0`版与`IEEE 802.3`兼容，都采用`CSMA/CD`技术实现介质访问控制，通过帧实现传输。不同：`DIX2.0`提供的服务对应`OSI/RM`的第一层和第二层，`IEEE 802.3`提供的服务对应于`OSI/RM`的第一层和第二层的MAC子层，LLC子层的功能由`IEEE 802.2`定义；`IEEE 802.3`定义了几种不同的物理层，而`DIX2.0`只定义了一个；帧格式也略有不同

（1）前导字符。每种格式的以太网帧都以64比特的前导字符作为开始。结构如下：

::: center
**表2-5** **前导字符结构**
:::
<table>
   <thead>
      <tr>
         <th colspan="7">前7字节：前同步码</th>
         <th>1字节：帧起始定界符</th>
      </tr>
   </thead>
   <tbody>
      <tr>
         <td>10101010</td>
         <td>10101010</td>
         <td>10101010</td>
         <td>10101010</td>
         <td>10101010</td>
         <td>10101010</td>
         <td>10101010</td>
         <td>10101011</td>
      </tr>
   </tbody>
</table>
作用：使接收端在接收MAC帧时能迅速实现比特同步。在检测到前导字符最后的连续两个1时，就知道后面的信息就是MAC帧了
（2）以太网帧格式。两种不同的帧结构如下：

::: center
**以太网帧结构**
:::
|6字节|6字节|2字节|||N字节|4字节|
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
|目的MAC地址|源MAC地址|类型|IP头部|TCP头部|数据|帧校验|

::: center
**IEEE 802.3帧结构**
:::
|6字节|6字节|2字节|1字节|1字节|2字节|N字节|4字节|
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
|目的MAC地址|源MAC地址|长度|DSAP|SSAP|控制字段|数据|帧校验|

### 3.2 CSMA/CD（**掌握**）

适用于总线型拓扑结构网络

1. 以太网时间槽
   最小帧长度发送时间应大于两倍传播时延。在10Mbit/s以太网中，一帧的最小发送时间必须为51.2us，即512bit数据在10Mbit/s以太网速率下的传播时间，因此以太网帧的最小长度为512bit=64B。
   为了保证达到最小帧长度，必须在不足的空间插入填充（Pad）字节

2. 载波监听多路访问CSMA
   按策略分为三类：
   - 非坚持CSMA
     - 原理：信道空闲，立即发送；信道忙，不再监听信道，等待一个随机时间，再重复上述过程
     - 优点：随机重发延迟时间可以减少冲突概率
     - 缺点：信道利用率低，增加了发送时延
   - 1-坚持CSMA
     - 原理：信道空闲，立即发送；信道忙，继续监听，直到空闲，立即发送；有冲突，等待一随机时间重复以上步骤
     - 优点：有利于抢占信道，避免信道利用率损失
     - 缺点：多个站点同时监听信道必然会发生冲突
   - P-坚持CSMA
     - 原理：信道空闲以P概率发送，以1-P的概率把发送推到下一时间单位。一个时间单位通常等于最大传播时延的2倍
     - 优点：既能减少冲突，也能减少空闲时间
     - 缺点：需要确定合适的P值。P值过大，nP>1，必会冲突；P值过小，等待时间较长，信道利用率低

3. 具有冲突检测的载波监听多路访问
   CSMA没有冲突检测功能，发生冲突会造成带宽浪费，为了进一步提高利用率，一种改进方案是边发送边监听
      - 发送过程继续监听信道，没有冲突，继续发送
      - 发生冲突，停止发送，并向总线发送干扰信号（Jamming），通知其他站点停止发送
      - 发送Jamming信号后等待一随机时间，重新监听，再尝试发送
  
   当重发次数超过16次时，MAC子层就会用异常终止当状态来通知LLC子层
   等待时间长短采用二进制指数退避算法：
   从{0,1,2,...,2^k^-1}中随机取一个数r，重发时延=r*基本重发时延。其中k=min(重发次数，10)。
   按后进先出（Last In First Out，LIFO）的次序来控制，即未发生冲突或很少发生冲突的数据帧，具有优先发送权

### 3.3 物理层（**了解**）

1. 物理层协议及接口
对于高速以太网，数据链路层协议基本与以太网相同，但物理层有所不同
   - MDI：介质相关接口（Media Dependent Interface， MDI）。定义了对应不同物理层介质和PDM设备所采用单连接器类型
   - MAU：介质访问单元（Media Attachment Unit，MAU）。
   - AUI：附属单元接口（Attachment Unit Interface，AUI）
   - PMD：物理介质相关（Physical Media Dependent，PMD）
   - PMA：物理介质附属（Physical Media Attachment，PMA）
   - PCS：物理编码子层（Physical Coding Sublayer，PCS）
   - MII/GMII/XGMII
   - 协调子层：

2. 以太网物理层规范
::: center
**表2-6** **常见以太网规范比较**
:::
|类型|速度/(bit/s)|最大网段|使用介质|
|:-:| :-:|:-:|:-:|
|10Base5|10M|500m|粗同轴电缆|
|10Base2|10M|185m|细同轴电缆|
|10Base-T|10M|100m|3类UTP|
|100Base-TX|100M|100m|5类UTP或STP|
|100Base-FX|100M|412m|多模/单模光纤|
|1000Base-T|1000M|100m|5类UTP|
|1000Base-LX|1000M|550m/5km|多模/单模光纤|
|1000Base-SX|1000M|220m~550m|多模光纤|
|1000Base-CX|1000M|25m|屏蔽双绞线|
|10GBase-SR|10G|300m|串行“光优化”多模光纤|
|10GBase-LR|10G|10km|串行，单模|
|10GBase-ER|10G|40km|串行，单模|
|10GBase-T|10G|55m/100m|六类UTP/七类UTP|

## 4 高速以太网

### 4.1 快速以太网（**了解**）

### 4.2 吉比特以太网（**了解**）

### 4.3 10Gbit/s以太网（**掌握**）

### 4.4 交换式以太网（**掌握**）

## 5 无线局域网

### 5.1 使用无线局域网的场合（**了解**）

### 5.2 无线局域网的构成方式（**掌握**）

### 5.3 无线局域网的协议标准IEEE802.11（**掌握**）

### 5.4 无线局域网的安全（**了解**）

### 5.5 无线局域网的特点与发展前景（**了解**）

## 6 局域网的规划设计

### 6.1 局域网的需求分析（**掌握**）

### 6.2 局域网的目标和原则（**掌握**）

### 6.3 网络总体设计（**掌握**）

### 6.4 设备选型与配置（**了解**）

---
# 这是文章的标题
title: ID3算法
# 你可以自定义封面图片
cover: /assets/images/cover2.jpg
# 这是页面的图标
icon: fa-solid fa-file-lines
# 这是侧边栏的顺序
order: 1
# 设置作者
author: Mr.Chuzs
# 设置写作时间
date: 2024-04-26
# 一个页面可以有多个分类
category:
  - 机器学习
# 一个页面可以有多个标签
tag:
  - 算法
  - 机器学习
  - 大数据
# 此页面会在文章列表置顶
sticky: false
# 此页面会出现在文章收藏中
star: true
# 你可以自定义页脚


#footer: 你走的每一步都算数
# 你可以自定义版权信息
#copyright: Copyright © 2023 Mr.Chuzs
---

`more` ID3算法

<!-- more -->

## 1 什么是熵

熵度量了事物的不确定性，越不确定的事物，熵越大。
随机变量X的熵公式如下：
$$
H(X)=-\sum_{i}p_ilogp_i
$$
其中n表示随机变量X的n种不同离散取值，pi表示X取值为i的概率，log表示以2为底或以e为底的对数。
假设随机变量X表示掷一枚硬币的结果，它有两种可能的取值，正面或反面，各占1/2，这时随机变量X的熵为：
$$
H(X)=-\sum_{i}p_ilogp_i=-(\frac{1}{2}*log\frac{1}{2}+\frac{1}{2}*log\frac{1}{2})=log2
$$
假设随机变量X表示掷一枚骰子的结果，它有六种可能的取值，{1,2,3,4,5,6}，各占1/6，这时随机变量X的熵为：
$$
H(X)=-\sum_{i}p_ilogp_i=-(\frac{1}{6}*log\frac{1}{6}*6)=log 6
$$
掷一枚骰子的不确定性比掷一枚硬币的不确定性大，熵值也大。
了解了熵的概念，下面我们详细介绍ID3算法。

## 2 ID3算法

在决策树的每一个节点，我们都要选择最优的特征进行分裂。那么怎么定义在该次分裂中该特征是最优选择？
ID3算法采用信息增益来衡量变量是不是最优的。我们Gain(D,a)来表示信息增益，具体公式如下：
$$
Gain(D,a)=Ent(D)-\sum\limits_{i=1}^n \frac{|D^v|}{|D|}Ent(D^v)
$$
其中D表示当前样本集合，a表示某个特征，$Ent(D)$表示信息熵，$|D|$表示样本集合中样本数量$|D^v|$表示特征a中v类样本数量，$Ent(D^v)$表示v类样本信息熵。
若当前样本集合D中总共有K类，其中第k类的样本所占比例为$p_k$，则D的信息熵公式如下：
$$
Ent(D)=-\sum\limits_{k=1}^k p_klog_2p_k
$$
为了更清晰地理解信息增益公式，以及决策树如何选择特征，我们看一个构造的简单例子：

| 编号  |     学历     | 是否有房 | 信贷表现 | 是否房贷 |
| :---: | :----------: | :------: | :------: | :------: |
|   1   |  初中及以下  |    有    |   良好   |    是    |
|   2   |  初中及以下  |    无    |   较差   |    否    |
|   3   |  初中及以下  |    有    |   良好   |    是    |
|   4   |  初中及以下  |    有    |   较差   |    否    |
|   5   |     高中     |    无    |  非常好  |    是    |
|   6   |     高中     |    有    |   良好   |    是    |
|   7   |     高中     |    有    |   较差   |    否    |
|   8   |     高中     |    有    |  非常好  |    是    |
|   9   |     高中     |    无    |   良好   |    是    |
|  10   |     高中     |    无    |   较差   |    否    |
|  11   |     大学     |    有    |   较差   |    否    |
|  12   |     大学     |    有    |   良好   |    是    |
|  13   |     大学     |    有    |  非常好  |    是    |
|  14   |     大学     |    无    |   良好   |    是    |
|  15   | 研究生及以上 |    有    |   良好   |    是    |
|  16   | 研究生及以上 |    有    |  非常好  |    是    |
|  17   | 研究生及以上 |    无    |   较差   |    否    |

正例(放贷)占$\frac{11}{17}$，反例占$\frac{6}{17}$，根节点的信息熵为：
$$
Ent(D)=-\sum\limits_{k=1}^k p_klog_2p_k=-(\frac{11}{17} log_2\frac{11}{17}+\frac{6}{17} log_2\frac{6}{17})=0.936
$$
计算当前特征集合{学历，是否有房子，信贷表现}中每个特征的信息增益，选择信息增益最大的特征进行分裂。

学历有4个可能取值：\{初中及以下，高中，大学，研究生及以上\}
D1(学历=初中及以下)={1，2，3，4}，正例2/4，反例2/4。
D2(学历=高中)={5，6，7，8，9，10}，正例4/6，反例2/6。
D3(学历=大学)={11，12，13，14}，正例3/4，反例1/4。
D4(学历=研究生及以上)={15，16，17}，正例2/3，反例1/3。
4个分支节点的信息熵为：
$$
Ent(D^1)=-(\frac{2}{4} log_2\frac{2}{4}+\frac{2}{4} log_2\frac{2}{4})=1
$$
$$
Ent(D^2)=-(\frac{4}{6} log_2\frac{4}{6}+\frac{2}{6} log_2\frac{2}{6})=0.918
$$
$$
Ent(D^3)=-(\frac{3}{4} log_2\frac{3}{4}+\frac{1}{4} log_2\frac{1}{4})=0.811
$$
$$
Ent(D^4)=-(\frac{1}{3} log_2\frac{1}{3}+\frac{2}{3} log_2\frac{2}{3})=0.918
$$